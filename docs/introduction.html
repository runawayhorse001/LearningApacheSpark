

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. An Introduction to Apache Spark &mdash; Learning Apache Spark with Python  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/icon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/fix_rtd.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Programming with RDDs" href="rdd.html" />
    <link rel="prev" title="3. Configure Running Platform" href="setup.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Learning Apache Spark with Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="why.html">2. Why Spark with Python ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">3. Configure Running Platform</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. An Introduction to Apache Spark</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#core-concepts">4.1. Core Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spark-components">4.2. Spark Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="#architecture">4.3. Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-spark-works">4.4. How Spark Works?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rdd.html">5. Programming with RDDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">6. Statistics and Linear Algebra Preliminaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">7. Data Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulation.html">8. Data Manipulation: Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">9. Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">10. Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification.html">11. Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">12. Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfm.html">13. RFM Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="textmining.html">14. Text Mining</a></li>
<li class="toctree-l1"><a class="reference internal" href="socialnetwork.html">15. Social Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="als.html">16. ALS: Stock Portfolio Recommendations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mc.html">17. Monte Carlo Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcmc.html">18. Markov Chain Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="fnn.html">19. Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto.html">20. Automation for Cloudera Distribution Hadoop</a></li>
<li class="toctree-l1"><a class="reference internal" href="pack.html">21. Wrap PySpark Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="audit.html">22. PySpark Data Audit Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="ze2nb.html">23. Zeppelin to jupyter notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheat.html">24. My Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="jdbc.html">25. JDBC Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="bricks.html">26. Databricks Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">27. PySpark API</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">28. Main Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Learning Apache Spark with Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>An Introduction to Apache Spark</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="an-introduction-to-apache-spark">
<span id="introduction"></span><h1><span class="section-number">4. </span>An Introduction to Apache Spark<a class="headerlink" href="#an-introduction-to-apache-spark" title="Permalink to this headline">¶</a></h1>
<div class="admonition-chinese-proverb admonition">
<p class="admonition-title">Chinese proverb</p>
<p><strong>Know yourself and know your enemy, and you will never be defeated</strong> – idiom, from Sunzi’s Art of War</p>
</div>
<div class="section" id="core-concepts">
<h2><span class="section-number">4.1. </span>Core Concepts<a class="headerlink" href="#core-concepts" title="Permalink to this headline">¶</a></h2>
<p>Most of the following content comes from <a class="reference internal" href="reference.html#kirillov2016" id="id1"><span>[Kirillov2016]</span></a>. So the copyright belongs to <strong>Anton Kirillov</strong>.
I will refer you to get more details from <a class="reference external" href="http://datastrophic.io/core-concepts-architecture-and-internals-of-apache-spark/">Apache Spark core concepts, architecture and internals</a>.</p>
<p>Before diving deep into how Apache Spark works, lets understand the jargon of Apache Spark</p>
<blockquote>
<div><ul class="simple">
<li><p>Job: A piece of code which reads some input from HDFS or local, performs some computation on the data and writes some output data.</p></li>
<li><p>Stages: Jobs are divided into stages. Stages are classified as a Map or reduce stages (Its easier to understand if you have worked on Hadoop and want to correlate). Stages are divided based on computational boundaries, all computations (operators) cannot be Updated in a single Stage. It happens over many stages.</p></li>
<li><p>Tasks: Each stage has some tasks, one task per partition. One task is executed on one partition of data on one executor (machine).</p></li>
<li><p>DAG: DAG stands for Directed Acyclic Graph, in the present context its a DAG of operators.</p></li>
<li><p>Executor: The process responsible for executing a task.</p></li>
<li><p>Master: The machine on which the Driver program runs</p></li>
<li><p>Slave: The machine on which the Executor program runs</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="spark-components">
<h2><span class="section-number">4.2. </span>Spark Components<a class="headerlink" href="#spark-components" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><blockquote>
<div><div class="figure align-center" id="fig-spark-components">
<img alt="_images/spark-components.png" src="_images/spark-components.png" />
</div>
</div></blockquote>
<ol class="arabic simple">
<li><p>Spark Driver</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>separate process to execute user applications</p></li>
<li><p>creates SparkContext to schedule jobs execution
and negotiate with cluster manager</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Executors</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>run tasks scheduled by driver</p></li>
<li><p>store computation results in memory, on disk or off-heap</p></li>
<li><p>interact with storage systems</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Cluster Manager</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Mesos</p></li>
<li><p>YARN</p></li>
<li><p>Spark Standalone</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Spark Driver contains more components responsible for translation
of user code into actual jobs executed on cluster:</p>
<blockquote>
<div><blockquote>
<div><div class="figure align-center" id="fig-spark-components1">
<img alt="_images/spark-components1.png" src="_images/spark-components1.png" />
</div>
</div></blockquote>
<ul>
<li><p>SparkContext</p>
<blockquote>
<div><ul class="simple">
<li><p>represents the connection to a Spark cluster, and can be used to create RDDs,
accumulators and broadcast variables  on that cluster</p></li>
</ul>
</div></blockquote>
</li>
<li><p>DAGScheduler</p>
<ul class="simple">
<li><p>computes a DAG of stages for each job and submits them to TaskScheduler
determines preferred locations for tasks (based on cache status or
shuffle files locations) and finds minimum schedule to run the jobs</p></li>
</ul>
</li>
<li><p>TaskScheduler</p>
<blockquote>
<div><ul class="simple">
<li><p>responsible for sending tasks to the cluster, running them,
retrying if there are failures, and mitigating stragglers</p></li>
</ul>
</div></blockquote>
</li>
<li><p>SchedulerBackend</p>
<blockquote>
<div><ul class="simple">
<li><p>backend interface for scheduling systems that allows plugging
in different implementations(Mesos, YARN, Standalone, local)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>BlockManager</p>
<blockquote>
<div><ul class="simple">
<li><p>provides interfaces for putting and retrieving blocks both locally
and remotely into various stores (memory,  disk, and off-heap)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="architecture">
<h2><span class="section-number">4.3. </span>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="how-spark-works">
<h2><span class="section-number">4.4. </span>How Spark Works?<a class="headerlink" href="#how-spark-works" title="Permalink to this headline">¶</a></h2>
<p>Spark has a small code base and the system is divided in various layers. Each layer has some responsibilities. The layers are independent of each other.</p>
<p>The first layer is the interpreter, Spark uses a Scala interpreter, with some modifications.
As you enter your code in spark console (creating RDD’s and applying operators), Spark creates a operator graph.
When the user runs an action (like collect), the Graph is submitted to a DAG Scheduler. The DAG scheduler divides operator graph into (map and reduce) stages.
A stage is comprised of tasks based on partitions of the input data. The DAG scheduler pipelines operators together to optimize the graph. For e.g. Many map operators can be scheduled in a single stage. This optimization is key to Sparks performance. The final result of a DAG scheduler is a set of stages.
The stages are passed on to the Task Scheduler. The task scheduler launches tasks via cluster manager. (Spark Standalone/Yarn/Mesos). The task scheduler doesn’t know about dependencies among stages.</p>
<blockquote>
<div><div class="figure align-center" id="fig-workflow">
<img alt="_images/work_flow.png" src="_images/work_flow.png" />
</div>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rdd.html" class="btn btn-neutral float-right" title="5. Programming with RDDs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="setup.html" class="btn btn-neutral float-left" title="3. Configure Running Platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Wenqiang Feng
      <span class="lastupdated">
        Last updated on Dec 27, 2021.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>